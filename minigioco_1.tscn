[gd_scene load_steps=6 format=3 uid="uid://o2sn21hp4o6q"]

[ext_resource type="Texture2D" uid="uid://u50vlx67dgir" path="res://02_Sfondi_EXPORT_ROTARY/Sfondo_1_sotto.png" id="1_dqomy"]
[ext_resource type="Texture2D" uid="uid://dqk8h2acy0fnk" path="res://02_Sfondi_EXPORT_ROTARY/Sfondo_1_sopra.png" id="3_16vsc"]
[ext_resource type="PackedScene" uid="uid://byqe3fujk7gld" path="res://track_manager.tscn" id="3_f0adg"]

[sub_resource type="Shader" id="Shader_blodx"]
code = "shader_type canvas_item;

uniform vec4 background_color : source_color;
uniform vec4 shadow_color : source_color;
// Currently pixels always in application size, so zooming in further wouldn't increase the size of the dropdown
// but changing that would also be relatively trivial
uniform vec2 offset_in_pixels;
uniform sampler2D SCREEN_TEXTURE : hint_screen_texture, filter_linear_mipmap;


void fragment() {
	
	// Read screen texture
	vec4 current_color = textureLod(SCREEN_TEXTURE, SCREEN_UV, 0.0);
	
	// Check if the current color is our background color
	if (length(current_color - background_color) < 0.01) {
		
		vec4 offset_color = textureLod(SCREEN_TEXTURE, SCREEN_UV - offset_in_pixels * SCREEN_PIXEL_SIZE, 0.0);
		
		// Check if at our offset position we have a color which is not the background (meaning here we need a shadow actually)
		if (length(offset_color - background_color) > 0.01) {
			// If so set it to our shadow color
			current_color = shadow_color;
		}
	}
	
	COLOR = current_color;
}"

[sub_resource type="ShaderMaterial" id="ShaderMaterial_4xuy4"]
shader = SubResource("Shader_blodx")
shader_parameter/background_color = Color(1, 1, 1, 1)
shader_parameter/shadow_color = null
shader_parameter/offset_in_pixels = Vector2(10, 10)

[node name="Minigioco_1" type="Node2D"]

[node name="Sfondo_sotto" type="Sprite2D" parent="."]
position = Vector2(960, 600)
texture = ExtResource("1_dqomy")

[node name="Sfondo_sopra" type="Sprite2D" parent="."]
position = Vector2(960, 600)
texture = ExtResource("3_16vsc")

[node name="ColorRect" type="ColorRect" parent="."]
material = SubResource("ShaderMaterial_4xuy4")
offset_right = 40.0
offset_bottom = 40.0

[node name="TrackManager_Left" parent="." instance=ExtResource("3_f0adg")]
position = Vector2(120, 540)

[node name="FoodTrack1" parent="TrackManager_Left" index="0"]
sprite_rotation = 90.0

[node name="FoodTrack2" parent="TrackManager_Left" index="1"]
position = Vector2(0, 135)
acceptable_id = "Carota"
sprite_rotation = 90.0

[node name="TrackManager_Right" parent="." instance=ExtResource("3_f0adg")]
position = Vector2(1788, 540)

[node name="FoodTrack1" parent="TrackManager_Right" index="0"]
acceptable_id = "Formaggio"
sprite_rotation = 90.0

[node name="FinishingPoint" parent="TrackManager_Right/FoodTrack1" index="0"]
position = Vector2(-653, 0)

[node name="FoodTrack2" parent="TrackManager_Right" index="1"]
position = Vector2(0, 135)
acceptable_id = "Gnocchi"
sprite_rotation = 90.0

[node name="FinishingPoint" parent="TrackManager_Right/FoodTrack2" index="0"]
position = Vector2(-653, 0)

[node name="TrackManager_Top" parent="." instance=ExtResource("3_f0adg")]
position = Vector2(895, -60)

[node name="FoodTrack1" parent="TrackManager_Top" index="0"]
acceptable_id = "Mozzarella"
sprite_rotation = 180.0

[node name="FinishingPoint" parent="TrackManager_Top/FoodTrack1" index="0"]
position = Vector2(8, 600)

[node name="FoodTrack2" parent="TrackManager_Top" index="1"]
position = Vector2(130, 1)
acceptable_id = "Pomodoro"
sprite_rotation = 180.0

[node name="FinishingPoint" parent="TrackManager_Top/FoodTrack2" index="0"]
position = Vector2(-6, 599)

[node name="TrackManager_Bottom" parent="." instance=ExtResource("3_f0adg")]
position = Vector2(895, 1268)

[node name="FoodTrack1" parent="TrackManager_Bottom" index="0"]
acceptable_id = "Uova"

[node name="FinishingPoint" parent="TrackManager_Bottom/FoodTrack1" index="0"]
position = Vector2(8, -594)

[node name="FoodTrack2" parent="TrackManager_Bottom" index="1"]
position = Vector2(130, 1)
acceptable_id = "Zucchina"

[node name="FinishingPoint" parent="TrackManager_Bottom/FoodTrack2" index="0"]
position = Vector2(-6, -595)

[editable path="TrackManager_Left"]
[editable path="TrackManager_Left/FoodTrack1"]
[editable path="TrackManager_Left/FoodTrack2"]
[editable path="TrackManager_Right"]
[editable path="TrackManager_Right/FoodTrack1"]
[editable path="TrackManager_Right/FoodTrack2"]
[editable path="TrackManager_Top"]
[editable path="TrackManager_Top/FoodTrack1"]
[editable path="TrackManager_Top/FoodTrack2"]
[editable path="TrackManager_Bottom"]
[editable path="TrackManager_Bottom/FoodTrack1"]
[editable path="TrackManager_Bottom/FoodTrack2"]
